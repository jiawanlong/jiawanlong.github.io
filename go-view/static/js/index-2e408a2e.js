import{d as F,$ as B,l as I,aL as z,M as V,r as n,o as L,D as Q,w as t,e,q as b,f as l,t as m,u as a,j as O,b9 as P,m as J,a1 as K,cs as W,ct as X,c as Y,cS as $,a8 as j,bi as Z}from"./index-6c47f69d.js";import{i as ee}from"./icon-da829856.js";import{S as D}from"./SettingItem-dc22b861.js";import{S as T}from"./SettingItemBox-53bd9f2b.js";import"./chartEditStore-bfe1babe.js";/* empty css                                                                      */import{R as te,a as ae}from"./pondIndex.vue_vue_type_style_index_0_scoped_bd608681_lang-462f8e37.js";import{u as oe}from"./useTargetData.hook-6aecbd70.js";import"./index-3782b823.js";import"./EditorWorker-2740485c.js";import"./editorWorker-259d4dbf.js";import{c as ne}from"./http-55a69c14.js";import{C as se}from"./index-1e301c26.js";import"./plugin-07aea9dd.js";import"./index-a89d093b.js";import"./fileTypeEnum-21359a08.js";const le={class:"go-pr-3"},re=F({__name:"index",props:{modelShow:Boolean,targetData:Object,saveBtnText:String||null},emits:["update:modelShow","sendHandle"],setup(w,{emit:H}){const u=w,p=H,{chartConfig:o}=B(u.targetData),{requestContentType:q}=B(u.targetData.request),_=I(!1),R={[z.DEFAULT]:"普通请求",[z.SQL]:"SQL 请求"};V(()=>u.modelShow,d=>{_.value=d},{immediate:!0});const x=()=>{p("update:modelShow",!1)},k=()=>{p("update:modelShow",!1),p("sendHandle")},r=()=>{x()};return(d,i)=>{const f=n("n-space"),g=n("n-scrollbar"),y=n("n-text"),h=n("n-tag"),S=n("n-button"),s=n("n-card"),c=n("n-modal");return L(),Q(c,{class:"go-chart-data-request",show:_.value,"onUpdate:show":i[0]||(i[0]=U=>_.value=U),"mask-closable":!1,closeOnEsc:!0,onEsc:r},{default:t(()=>[e(s,{bordered:!1,role:"dialog",size:"small","aria-modal":"true",style:{width:"1000px",height:"800px"}},{header:t(()=>[]),"header-extra":t(()=>[]),action:t(()=>[e(f,{justify:"space-between"},{default:t(()=>[b("div",null,[e(y,null,{default:t(()=>[l("「 "+m(a(o).categoryName)+" 」",1)]),_:1}),e(y,null,{default:t(()=>[l("—— ")]),_:1}),e(h,{type:"primary",bordered:!1,style:{"border-radius":"5px"}},{default:t(()=>[l(m(R[a(q)]),1)]),_:1})]),b("div",null,[e(S,{class:"go-mr-3",onClick:x},{default:t(()=>[l("取消")]),_:1}),e(S,{type:"primary",onClick:k},{default:t(()=>[l(m(w.saveBtnText||"保存 & 发送请求"),1)]),_:1})])]),_:1})]),default:t(()=>[e(g,{style:{"max-height":"718px"}},{default:t(()=>[b("div",le,[e(f,{vertical:""},{default:t(()=>[e(a(te)),e(a(ae),{"target-data-request":w.targetData?.request},null,8,["target-data-request"])]),_:1})])]),_:1})]),_:1})]),_:1},8,["show"])}}}),ce=O(re,[["__scopeId","data-v-a6c5f5bb"]]),ue={class:"go-chart-configurations-data-ajax"},de={class:"go-absolute-center"},ie=F({__name:"index",setup(w){P(s=>({"272613bc":S.value}));const{HelpOutlineIcon:H,FlashIcon:u,PulseIcon:p}=ee.ionicons5,{targetData:o,chartEditStore:q}=oe(),{requestOriginUrl:_,requestInterval:R,requestIntervalUnit:x}=B(q.getRequestGlobalConfig),k=J(),r=I(!1),d=I(!1),i=I(!1);let f=0,g;const y=()=>{d.value=!0},h=async()=>{if(o.value?.request){r.value=!0;try{const s=await ne(j(o.value.request),j(q.getRequestGlobalConfig));if(r.value=!1,s){const{data:c}=s;if(!c&&!o.value.filter){window.$message.warning("您的数据不符合默认格式，请配置过滤器！"),i.value=!0;return}o.value.option.dataset=Z(c,s,o.value.filter),i.value=!0;return}window.$message.warning("没有拿到返回值，请检查接口！")}catch(s){console.error(s),r.value=!1,window.$message.warning("数据异常，请检查参数！")}}},S=K(()=>k.getAppTheme);return W(()=>{const s=o.value?.filter;g!==s&&f&&(g=s,h()),f++}),X(()=>{g=null}),(s,c)=>{const U=n("n-tag"),v=n("n-input"),C=n("n-icon"),E=n("n-button"),A=n("n-card"),G=n("n-tooltip"),N=n("go-skeleton");return L(),Y("div",ue,[e(A,{class:"n-card-shallow"},{default:t(()=>[e(a(T),{name:"请求配置"},{default:t(()=>[e(a(D),{name:"类型"},{default:t(()=>[e(U,{bordered:!1,type:"primary",style:{"border-radius":"5px"}},{default:t(()=>[l(m(a(o).request.requestContentType===a(z).DEFAULT?"普通请求":"SQL请求"),1)]),_:1})]),_:1}),e(a(D),{name:"方式"},{default:t(()=>[e(v,{size:"small",placeholder:a(o).request.requestHttpType||"暂无",disabled:!0},null,8,["placeholder"])]),_:1}),e(a(D),{name:"组件间隔"},{default:t(()=>[e(v,{size:"small",placeholder:`${a(o).request.requestInterval||"暂无"}`,disabled:!0},{suffix:t(()=>[l(m(a($)[a(o).request.requestIntervalUnit]),1)]),_:1},8,["placeholder"])]),_:1}),e(a(D),{name:"全局间隔（默认）"},{default:t(()=>[e(v,{size:"small",placeholder:`${a(R)||"暂无"} `,disabled:!0},{suffix:t(()=>[l(m(a($)[a(x)]),1)]),_:1},8,["placeholder"])]),_:1})]),_:1}),e(a(T),{name:"源地址",alone:!0},{default:t(()=>[e(v,{size:"small",placeholder:a(_)||"暂无",disabled:!0},{prefix:t(()=>[e(C,{component:a(p)},null,8,["component"])]),_:1},8,["placeholder"])]),_:1}),e(a(T),{name:"组件地址",alone:!0},{default:t(()=>[e(v,{size:"small",placeholder:a(o).request.requestUrl||"暂无",disabled:!0},{prefix:t(()=>[e(C,{component:a(u)},null,8,["component"])]),_:1},8,["placeholder"])]),_:1}),b("div",{class:"edit-text",onClick:y},[b("div",de,[e(E,{type:"primary",secondary:""},{default:t(()=>[l("编辑配置")]),_:1})])])]),_:1}),e(a(T),{alone:!0},{name:t(()=>[l(" 测试 "),e(G,{trigger:"hover"},{trigger:t(()=>[e(C,{size:"21",depth:3},{default:t(()=>[e(a(H))]),_:1})]),default:t(()=>[l(" 默认赋值给 dataset 字段 ")]),_:1})]),default:t(()=>[e(E,{type:"primary",ghost:"",onClick:h},{icon:t(()=>[e(C,null,{default:t(()=>[e(a(u))]),_:1})]),default:t(()=>[l(" 发送请求 ")]),_:1})]),_:1}),e(a(se),{show:i.value&&!r.value,ajax:!0},null,8,["show"]),e(N,{load:r.value,repeat:3},null,8,["load"]),e(a(ce),{modelShow:d.value,"onUpdate:modelShow":c[0]||(c[0]=M=>d.value=M),targetData:a(o),onSendHandle:h},null,8,["modelShow","targetData"])])}}});const Ie=O(ie,[["__scopeId","data-v-688badbe"]]);export{Ie as default};
